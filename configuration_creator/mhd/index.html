<!DOCTYPE html>
<html><head><meta charset="utf-8"></meta></head></html>
<!--
Interactive interface for creating configuration files for MHD test of PAMHD.

Copyright 2015, 2016 Ilja Honkonen
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice, this
  list of conditions and the following disclaimer in the documentation and/or
  other materials provided with the distribution.

* Neither the names of the copyright holders nor the names of their contributors
  may be used to endorse or promote products derived from this software
  without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html>
<head>
<title>Interactive configuration file creator for MHD test program of PAMHD</title>

<style type="text/css">
div[id ^= "bdy_input"] {display: inline-block;}
</style>

<!-- javascript block start -->

<noscript>
	<p><h1>WARNING: This page does not work without javascript</h1></p>
</noscript>
<!-- javascript functions start -->
<script name="script" type="text/javascript">


window.onload = function() {


//! Returns a text input element with given id and identical name.
function make_input_element(id_string)
{
	var input = document.createElement("input");
	input.setAttribute("type", "text");
	input.setAttribute("id", id_string);
	input.setAttribute("name", id_string);
	return input;
}


function make_span(id_string)
{
	var span = document.createElement("span");
	span.setAttribute("id", id_string);
	return span;
}


// geometry related stuff
var nr_geometries = 0;

// removes last exiting geometry
function remove_geometry()
{
	if (nr_geometries <= 0) {
		return;
	}

	geometry_id = (nr_geometries - 1).toString();
	nr_geometries = nr_geometries - 1;

	box = document.getElementById("box" + geometry_id);
	if (box != null) {
		box.parentNode.removeChild(box);
		return;
	}

	sphere = document.getElementById("sphere" + geometry_id);
	if (sphere != null) {
		sphere.parentNode.removeChild(sphere);
		return;
	}

	alert("Unexpected shape in geometry id " + geometry_id);
}

geometry_remover = document.getElementById("remove_geometry_btn");
geometry_remover.addEventListener("click", remove_geometry);

// adds geometry of given shape after last existing geometry
function make_geometry(shape)
{

	if (shape != "box" && shape != "sphere") {
		alert("Unsupported geometry given to make_geometry");
	}

	geometry_id = nr_geometries.toString();
	nr_geometries = nr_geometries + 1;

	id_string = shape + geometry_id;

	var fieldset = document.createElement("fieldset");
	fieldset.setAttribute("id", id_string);

	var legend = document.createElement("legend");
	if (shape == "box") {
		legend.innerHTML = "Box";
	} else if (shape == "sphere") {
		legend.innerHTML = "Sphere";
	}
	legend.innerHTML = legend.innerHTML + ", geometry id: " + geometry_id;
	fieldset.appendChild(legend);

	if (shape == "box") {

		fieldset.appendChild(document.createTextNode("Start coordinate (x, y, z) "));
		fieldset.appendChild(make_input_element(id_string + "-startx"));
		fieldset.appendChild(make_input_element(id_string + "-starty"));
		fieldset.appendChild(make_input_element(id_string + "-startz"));
		fieldset.appendChild(document.createElement("br"));

		fieldset.appendChild(document.createTextNode("End coordinate (x, y, z) "));
		fieldset.appendChild(make_input_element(id_string + "-endx"));
		fieldset.appendChild(make_input_element(id_string + "-endy"));
		fieldset.appendChild(make_input_element(id_string + "-endz"));
		fieldset.appendChild(document.createElement("br"));

	} else if (shape == "sphere") {

		fieldset.appendChild(document.createTextNode("Center coordinate (x, y, z) "));
		fieldset.appendChild(make_input_element(id_string + "-centerx"));
		fieldset.appendChild(make_input_element(id_string + "-centery"));
		fieldset.appendChild(make_input_element(id_string + "-centerz"));
		fieldset.appendChild(document.createElement("br"));

		fieldset.appendChild(document.createTextNode("Radius "));
		fieldset.appendChild(make_input_element(id_string + "-radius"));
		fieldset.appendChild(document.createElement("br"));
	}

	document.getElementById("geometries").appendChild(fieldset);
}

box_geometry_adder = document.getElementById("add_box_geometry"),
box_geometry_adder.addEventListener("click", function() {
   make_geometry("box");
});

sphere_geometry_adder = document.getElementById("add_sphere_geometry"),
sphere_geometry_adder.addEventListener("click", function() {
   make_geometry("sphere");
});


function is_valid_geometry_id()
{
	notification = document.getElementById(this.id + "-test");
	if (
		isFinite(this.value)
		&& this.value >= 0
		&& this.value < nr_geometries
	) {
		notification.innerHTML = "";
		notification.style.color = "initial";
	} else {
		notification.innerHTML = "Invalid geometry id";
		notification.style.color = "red";
	}
}


// background magnetic field related stuff
var nr_dipoles = 0;

function remove_dipole()
{
	if (nr_dipoles <= 0) {
		return;
	}
	nr_dipoles = nr_dipoles - 1;

	dipole = document.getElementById("dipole_" + nr_dipoles.toString());
	if (dipole != null) {
		dipole.parentNode.removeChild(dipole);
	}
}
dipole_remover = document.getElementById("remove_dipole");
dipole_remover.addEventListener("click", remove_dipole);

function add_dipole()
{
	fieldset = document.createElement("fieldset");
	dipole_id = "dipole_" + nr_dipoles.toString();
	fieldset.setAttribute("id", dipole_id);
	fieldset.appendChild(document.createTextNode("Moment (A m^2) "));
	fieldset.appendChild(make_input_element(dipole_id + "-moment-x"));
	fieldset.appendChild(make_input_element(dipole_id + "-moment-y"));
	fieldset.appendChild(make_input_element(dipole_id + "-moment-z"));
	fieldset.appendChild(document.createElement("br"));
	fieldset.appendChild(document.createTextNode("Position "));
	fieldset.appendChild(make_input_element(dipole_id + "-position-x"));
	fieldset.appendChild(make_input_element(dipole_id + "-position-y"));
	fieldset.appendChild(make_input_element(dipole_id + "-position-z"));
	document.getElementById("background_B").appendChild(fieldset);
	nr_dipoles = nr_dipoles + 1;
}
dipole_adder = document.getElementById("add_dipole");
dipole_adder.addEventListener("click", add_dipole);


// creates an input set for a boundary
function get_bdy_input_common(id_string, add_values, add_time_stamps)
{
	div = document.createElement("div");
	div.setAttribute("id", "bdy-input-" + id_string);

	// add checked input for geometry id
	div.appendChild(document.createTextNode("Region (geometry id): "));
	geometry_input = make_input_element(id_string + "-geometry-id");
	geometry_input.onblur = is_valid_geometry_id;
	div.appendChild(geometry_input);
	div.appendChild(make_span(id_string + "-geometry-id-test"));

	if (add_time_stamps == true) {
		div.appendChild(document.createElement("br"));
		div.appendChild(document.createTextNode("Time stamps: "));
		time_stamps_input = make_input_element(id_string + "-time-stamps-id");
		div.appendChild(time_stamps_input);
	}

	if (add_values == true) {
		div.appendChild(document.createElement("br"));
		div.appendChild(document.createTextNode(" Values: "));
		div.appendChild(make_input_element(id_string + "-value"));
		div.appendChild(document.createElement("br"));
	}

	return div;
}


// removes last boundary of given type from given variable
function remove_boundary_item(variable, nr_items, bdy_type)
{
	if (nr_items.n <= 0) {
		return;
	}

	nr_items.n = nr_items.n - 1;

	fieldset = document.getElementById(bdy_type + "-" + variable + "-fieldset");
	if (fieldset != null) {
		div = document.getElementById(
			"bdy-input-" + bdy_type + "-"
			+ variable + "-"
			+ nr_items.n.toString()
		);
		fieldset.removeChild(div);
	}

	if (nr_items.n == 0) {
		fieldset.parentNode.removeChild(fieldset);
	}
}

function remove_initial_item(variable, nr_items)
{
	remove_boundary_item(variable, nr_items, "initial");
}

// adds initial condition of given variable
function add_initial_item(variable, nr_items, remover, info)
{
	fieldset = document.getElementById("initial-" + variable + "-fieldset");
	if (fieldset == null) {
		fieldset = document.createElement("fieldset");
		fieldset.setAttribute("id", "initial-" + variable + "-fieldset");
		legend = document.createElement("legend");
		legend.innerHTML = "Initial conditions";
		fieldset.appendChild(legend);

		button = document.createElement("button");
		button.addEventListener("click", remover);
		button.setAttribute("id", "remove-initial-" + variable);
		button.setAttribute("type", "button");
		button.innerHTML = "Remove last item";
		fieldset.appendChild(button);
		fieldset.appendChild(document.createElement("br"));
		info.appendChild(fieldset);
	}

	item_id = nr_items.n.toString();
	nr_items.n = nr_items.n + 1;
	id_string = "initial-" + variable + "-" + item_id;

	fieldset.appendChild(get_bdy_input_common(id_string, true, false));
}

// adds value boundary of given variable
function add_value_item(variable, nr_items, remover, info)
{
	fieldset = document.getElementById("value-" + variable + "-fieldset");
	if (fieldset == null) {
		fieldset = document.createElement("fieldset");
		fieldset.setAttribute("id", "value-" + variable + "-fieldset");
		legend = document.createElement("legend");
		legend.innerHTML = "Value boundaries";
		fieldset.appendChild(legend);

		button = document.createElement("button");
		button.addEventListener("click", remover);
		button.setAttribute("id", "remove-value-" + variable);
		button.setAttribute("type", "button");
		button.innerHTML = "Remove last item";
		fieldset.appendChild(button);
		fieldset.appendChild(document.createElement("br"));
		info.appendChild(fieldset);
	}

	item_id = nr_items.n.toString();
	nr_items.n = nr_items.n + 1;
	id_string = "value-" + variable + "-" + item_id;

	fieldset.appendChild(get_bdy_input_common(id_string, true, true));
}

// adds copy boundary of given variable
function add_copy_item(variable, nr_items, remover, info)
{
	fieldset = document.getElementById("copy-" + variable + "-fieldset");
	if (fieldset == null) {
		fieldset = document.createElement("fieldset");
		fieldset.setAttribute("id", "copy-" + variable + "-fieldset");
		legend = document.createElement("legend");
		legend.innerHTML = "Copy boundaries";
		fieldset.appendChild(legend);

		button = document.createElement("button");
		button.addEventListener("click", remover);
		button.setAttribute("id", "remove-copy-" + variable);
		button.setAttribute("type", "button");
		button.innerHTML = "Remove last item";
		fieldset.appendChild(button);
		fieldset.appendChild(document.createElement("br"));
		info.appendChild(fieldset);
	}

	item_id = nr_items.n.toString();
	nr_items.n = nr_items.n + 1;
	id_string = "copy-" + variable + "-" + item_id;

	fieldset.appendChild(get_bdy_input_common(id_string, false, false));
}


// number density related stuff

// allow passing by reference
var nr_initial_mass_items = {n: 0};

function remove_initial_mass_item() {
	remove_initial_item("mass", nr_initial_mass_items);
}

function add_initial_mass_item() {
	add_initial_item(
		"mass",
		nr_initial_mass_items,
		remove_initial_mass_item,
		document.getElementById("number_density_info")
	);
}
initial_mass_adder = document.getElementById("add_initial_mass");
initial_mass_adder.addEventListener("click", add_initial_mass_item);


var nr_value_mass_items = {n: 0};

function remove_value_mass_item() {
	remove_boundary_item("mass", nr_value_mass_items, "value");
}

function add_value_mass_item() {
	add_value_item(
		"mass",
		nr_value_mass_items,
		remove_value_mass_item,
		document.getElementById("number_density_info")
	);
}
value_mass_adder = document.getElementById("add_value_mass");
value_mass_adder.addEventListener("click", add_value_mass_item);


var nr_copy_mass_items = {n: 0};

function remove_copy_mass_item() {
	remove_boundary_item("mass", nr_copy_mass_items, "copy");
}

function add_copy_mass_item() {
	add_copy_item(
		"mass",
		nr_copy_mass_items,
		remove_copy_mass_item,
		document.getElementById("number_density_info")
	);
}
copy_mass_adder = document.getElementById("add_copy_mass");
copy_mass_adder.addEventListener("click", add_copy_mass_item);


// velocity related stuff
var nr_initial_velocity_items = {n: 0};

function remove_initial_velocity_item() {
	remove_initial_item("velocity", nr_initial_velocity_items);
}

function add_initial_velocity_item() {
	add_initial_item(
		"velocity",
		nr_initial_velocity_items,
		remove_initial_velocity_item,
		document.getElementById("velocity_info")
	);
}
initial_velocity_adder = document.getElementById("add_initial_velocity");
initial_velocity_adder.addEventListener("click", add_initial_velocity_item);


var nr_value_velocity_items = {n: 0};

function remove_value_velocity_item() {
	remove_boundary_item("velocity", nr_value_velocity_items, "value");
}

function add_value_velocity_item() {
	add_value_item(
		"velocity",
		nr_value_velocity_items,
		remove_value_velocity_item,
		document.getElementById("velocity_info")
	);
}
value_velocity_adder = document.getElementById("add_value_velocity");
value_velocity_adder.addEventListener("click", add_value_velocity_item);


var nr_copy_velocity_items = {n: 0};

function remove_copy_velocity_item() {
	remove_boundary_item("velocity", nr_copy_velocity_items, "copy");
}

function add_copy_velocity_item() {
	add_copy_item(
		"velocity",
		nr_copy_velocity_items,
		remove_copy_velocity_item,
		document.getElementById("velocity_info")
	);
}
copy_velocity_adder = document.getElementById("add_copy_velocity");
copy_velocity_adder.addEventListener("click", add_copy_velocity_item);


// pressure related stuff
var nr_initial_pressure_items = {n: 0};

function remove_initial_pressure_item() {
	remove_initial_item("pressure", nr_initial_pressure_items);
}

function add_initial_pressure_item() {
	add_initial_item(
		"pressure",
		nr_initial_pressure_items,
		remove_initial_pressure_item,
		document.getElementById("pressure_info")
	);
}
initial_pressure_adder = document.getElementById("add_initial_pressure");
initial_pressure_adder.addEventListener("click", add_initial_pressure_item);


var nr_value_pressure_items = {n: 0};

function remove_value_pressure_item() {
	remove_boundary_item("pressure", nr_value_pressure_items, "value");
}

function add_value_pressure_item() {
	add_value_item(
		"pressure",
		nr_value_pressure_items,
		remove_value_pressure_item,
		document.getElementById("pressure_info")
	);
}
value_pressure_adder = document.getElementById("add_value_pressure");
value_pressure_adder.addEventListener("click", add_value_pressure_item);


var nr_copy_pressure_items = {n: 0};

function remove_copy_pressure_item() {
	remove_boundary_item("pressure", nr_copy_pressure_items, "copy");
}

function add_copy_pressure_item() {
	add_copy_item(
		"pressure",
		nr_copy_pressure_items,
		remove_copy_pressure_item,
		document.getElementById("pressure_info")
	);
}
copy_pressure_adder = document.getElementById("add_copy_pressure");
copy_pressure_adder.addEventListener("click", add_copy_pressure_item);


// magnetic field related stuff
var nr_initial_magnetic_field_items = {n: 0};

function remove_initial_magnetic_field_item() {
	remove_initial_item("magnetic-field", nr_initial_magnetic_field_items);
}

function add_initial_magnetic_field_item() {
	add_initial_item(
		"magnetic-field",
		nr_initial_magnetic_field_items,
		remove_initial_magnetic_field_item,
		document.getElementById("magnetic_field_info")
	);
}
initial_magnetic_field_adder = document.getElementById("add_initial_magnetic_field");
initial_magnetic_field_adder.addEventListener("click", add_initial_magnetic_field_item);


var nr_value_magnetic_field_items = {n: 0};

function remove_value_magnetic_field_item() {
	remove_boundary_item("magnetic-field", nr_value_magnetic_field_items, "value");
}

function add_value_magnetic_field_item() {
	add_value_item(
		"magnetic-field",
		nr_value_magnetic_field_items,
		remove_value_magnetic_field_item,
		document.getElementById("magnetic_field_info")
	);
}
value_magnetic_field_adder = document.getElementById("add_value_magnetic_field");
value_magnetic_field_adder.addEventListener("click", add_value_magnetic_field_item);


var nr_copy_magnetic_field_items = {n: 0};

function remove_copy_magnetic_field_item() {
	remove_boundary_item("magnetic-field", nr_copy_magnetic_field_items, "copy");
}

function add_copy_magnetic_field_item() {
	add_copy_item(
		"magnetic-field",
		nr_copy_magnetic_field_items,
		remove_copy_magnetic_field_item,
		document.getElementById("magnetic_field_info")
	);
}
copy_magnetic_field_adder = document.getElementById("add_copy_magnetic_field");
copy_magnetic_field_adder.addEventListener("click", add_copy_magnetic_field_item);


// clears current configuration
var configuration_clearer = document.getElementById("clear");
configuration_clearer.addEventListener("click", function() {
	document.getElementById("solver-mhd").selectedIndex = 3;
	document.getElementById("time-start").value = "";
	document.getElementById("time-length").value = "";
	document.getElementById("save-mhd-n").value = "";
	document.getElementById("resistivity").value = "";
	document.getElementById("remove-div-b-n").value = "";
	document.getElementById("adiabatic-index").value = "";
	document.getElementById("vacuum-permeability").value = "";
	document.getElementById("proton-mass").value = "";
	document.getElementById("time-step-factor").value = "";
	document.getElementById("output-directory").value = "";
	document.getElementById("periodic-x").selectedIndex = 0;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("cells").value = "";
	document.getElementById("volume").value = "";
	document.getElementById("start").value = "";
	document.getElementById("default-mass").value = "";
	document.getElementById("default-pressure").value = "";
	document.getElementById("default-velocity").value = "";
	document.getElementById("default-magnetic-field").value = "";
	while (nr_geometries > 0) {
		remove_geometry();
	}
	while (nr_dipoles > 0) {
		remove_dipole();
	}
	while (nr_initial_mass_items.n > 0) {
		remove_initial_mass_item();
	}
	while (nr_value_mass_items.n > 0) {
		remove_value_mass_item();
	}
	while (nr_copy_mass_items.n > 0) {
		remove_copy_mass_item();
	}
	while (nr_initial_velocity_items.n > 0) {
		remove_initial_velocity_item();
	}
	while (nr_value_velocity_items.n > 0) {
		remove_value_velocity_item();
	}
	while (nr_copy_velocity_items.n > 0) {
		remove_copy_velocity_item();
	}
	while (nr_initial_pressure_items.n > 0) {
		remove_initial_pressure_item();
	}
	while (nr_value_pressure_items.n > 0) {
		remove_value_pressure_item();
	}
	while (nr_copy_pressure_items.n > 0) {
		remove_copy_pressure_item();
	}
	while (nr_initial_magnetic_field_items.n > 0) {
		remove_initial_magnetic_field_item();
	}
	while (nr_value_magnetic_field_items.n > 0) {
		remove_value_magnetic_field_item();
	}
	while (nr_copy_magnetic_field_items.n > 0) {
		remove_copy_magnetic_field_item();
	}
});


// sets innerHTML of item with id config_text to current configuration
var config_text_updater = document.getElementById("update_config_text");
config_text_updater.addEventListener("click", function() {
	var new_html
		= "<br>{<br>"
		+ "&quot;output-directory&quot;: &quot;"
		+ document.getElementById("output-directory").value + "&quot;,<br>"
		+ "&quot;solver-mhd&quot;: &quot;"
		+ document.getElementById("solver-mhd").value + "&quot;,<br>"
		+ "&quot;time-start&quot;: "
		+ document.getElementById("time-start").value + ",<br>"
		+ "&quot;time-length&quot;: "
		+ document.getElementById("time-length").value + ",<br>"
		+ "&quot;minimum-pressure&quot;: "
		+ document.getElementById("minimum-pressure").value + ",<br>"
		+ "&quot;save-mhd-n&quot;: "
		+ document.getElementById("save-mhd-n").value + ",<br>"
		+ "&quot;resistivity&quot;: &quot;"
		+ document.getElementById("resistivity").value + "&quot;,<br>"
		+ "&quot;remove-div-B-n&quot;: "
		+ document.getElementById("remove-div-b-n").value + ",<br>"
		+ "&quot;adiabatic-index&quot;: "
		+ document.getElementById("adiabatic-index").value + ",<br>"
		+ "&quot;vacuum-permeability&quot;: "
		+ document.getElementById("vacuum-permeability").value + ",<br>"
		+ "&quot;proton-mass&quot;: "
		+ document.getElementById("proton-mass").value + ",<br>"
		+ "&quot;time-step-factor&quot;: "
		+ document.getElementById("time-step-factor").value + ",<br>"
		+ "&quot;load-balancer&quot;: &quot;RCB&quot;,<br>"
		+ "&quot;poisson-norm-stop&quot;: 1e-10,<br>"
		+ "&quot;poisson-norm-increase-max&quot;: 10,<br>"
		+ "&quot;grid-options&quot;: {<br>"
		+ "&nbsp;&nbsp;&quot;periodic&quot;: &quot;{"
		+ document.getElementById("periodic-x").value + ", "
		+ document.getElementById("periodic-y").value + ", "
		+ document.getElementById("periodic-z").value + "}&quot;,<br>"
		+ "&nbsp;&nbsp;&quot;cells&quot;: &quot;"
		+ document.getElementById("cells").value + "&quot;,<br>"
		+ "&nbsp;&nbsp;&quot;volume&quot;: &quot;"
		+ document.getElementById("volume").value + "&quot;,<br>"
		+ "&nbsp;&nbsp;&quot;start&quot;: &quot;"
		+ document.getElementById("start").value + "&quot;<br>"
		+ "},<br>";

	// geometries
	if (nr_geometries > 0) {
		new_html += "&quot;geometries&quot;: [<br>"
		for (i = 0; i < nr_geometries; i++) {
			box_id = "box" + i.toString()
			box = document.getElementById(box_id);
			if (box != null) {
				new_html
					+= "&nbsp;&nbsp;{&quot;box&quot;: {<br>"
					+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;start&quot;: ["
					+ document.getElementById(box_id + "-startx").value + ", "
					+ document.getElementById(box_id + "-starty").value + ", "
					+ document.getElementById(box_id + "-startz").value + "],<br>"
					+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;end&quot;: ["
					+ document.getElementById(box_id + "-endx").value + ", "
					+ document.getElementById(box_id + "-endy").value + ", "
					+ document.getElementById(box_id + "-endz").value + "]<br>&nbsp;&nbsp;}}"

				if (i < nr_geometries - 1) {
					new_html += ",";
				}
				new_html += "<br>";
				continue;
			}

			sphere_id = "sphere" + i.toString()
			sphere = document.getElementById(sphere_id);
			if (sphere != null) {
				new_html
					+= "&nbsp;&nbsp;{&quot;sphere&quot;: {<br>"
					+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;center&quot;: ["
					+ document.getElementById(sphere_id + "-centerx").value + ", "
					+ document.getElementById(sphere_id + "-centery").value + ", "
					+ document.getElementById(sphere_id + "-centerz").value + "],<br>"
					+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;radius&quot;: "
					+ document.getElementById(sphere_id + "-radius").value + "<br>&nbsp;&nbsp;}}"

				if (i < nr_geometries - 1) {
					new_html += ",";
				}
				new_html += "<br>";
				continue;
			}
		}
		new_html += "],<br>";
	}


	// background magnetic field
	new_html
		+= "&quot;background-magnetic-field&quot;: {<br>"
		+ "&nbsp;&nbsp;&quot;value&quot;: ["
		+ document.getElementById("background-B-value-x").value + ", "
		+ document.getElementById("background-B-value-y").value + ", "
		+ document.getElementById("background-B-value-z").value
		+ "],<br>&nbsp;&nbsp;&quot;minimum-distance&quot;: "
		+ document.getElementById("dipole-min-distance").value;
	if (nr_dipoles > 0) {
		new_html += ",<br>&nbsp;&nbsp;&quot;dipoles&quot;: [<br>";
	} else {
		new_html += "<br>";
	}
	for (i = 0; i < nr_dipoles; i++) {
		dipole_id = "dipole_" + i.toString();
		dipole = document.getElementById(dipole_id);
		if (dipole != null) {
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;moment&quot;: ["
				+ document.getElementById(dipole_id + "-moment-x").value + ", "
				+ document.getElementById(dipole_id + "-moment-y").value + ", "
				+ document.getElementById(dipole_id + "-moment-z").value
				+ "],&quot;position&quot;: ["
				+ document.getElementById(dipole_id + "-position-x").value + ", "
				+ document.getElementById(dipole_id + "-position-y").value + ", "
				+ document.getElementById(dipole_id + "-position-z").value
				+ "]}";

			if (i < nr_dipoles - 1) {
				new_html += ",";
			}
			new_html += "<br>";
			continue;
		}
	}
	if (nr_dipoles > 0) {
		new_html += "&nbsp;&nbsp;]<br>";
	}
	new_html += "},<br>";


	// "number-density": { and "default": "",
	new_html
		+= "&quot;number-density&quot;: {<br>"
		+ "&nbsp;&nbsp;&quot;default&quot;: &quot;"
		+ document.getElementById("default-mass").value + "&quot;";

	if (
		nr_initial_mass_items.n > 0
		|| nr_value_mass_items.n > 0
		|| nr_copy_mass_items.n > 0
	) {
		new_html += ",<br>";
	}
	// "initial-conditions": [
	if (nr_initial_mass_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;initial-conditions&quot;: [<br>";
		for (i = 0; i < nr_initial_mass_items.n; i++) {
			id_string = "initial-mass-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + ",<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;value&quot;: &quot;"
				+ document.getElementById(id_string + "-value").value + "&quot;"
				+ "}";
			if (i < nr_initial_mass_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	if (nr_initial_mass_items.n > 0 && nr_value_mass_items.n > 0) {
		if (nr_value_mass_items.n > 0) {
			new_html += ",";
		}
		new_html += "<br>";
	}

	// "value-boundaries": [
	if (nr_value_mass_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;value-boundaries&quot;: [<br>";
		for (i = 0; i < nr_value_mass_items.n; i++) {
			id_string = "value-mass-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + ",<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;time-stamps&quot;: ["
				+ document.getElementById(id_string + "-time-stamps-id").value + "],<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;values&quot;: ["
				+ '"' + document.getElementById(id_string + "-value").value.replace(/\,/g, '","')
				+ '"]}';
			if (i < nr_value_mass_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	if (
		(nr_initial_mass_items.n > 0 || nr_value_mass_items.n > 0)
		&& nr_copy_mass_items.n > 0
	) {
		if (nr_copy_mass_items.n > 0) {
			new_html += ",";
		}
		new_html += "<br>";
	}

	// "copy-boundaries": [
	if (nr_copy_mass_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;copy-boundaries&quot;: [<br>";
		for (i = 0; i < nr_copy_mass_items.n; i++) {
			id_string = "copy-mass-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + "&nbsp;&nbsp;&nbsp;&nbsp;}";
			if (i < nr_copy_mass_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	new_html += "<br>},<br>";


	// velocity
	new_html
		+= "&quot;velocity&quot;: {<br>"
		+ "&nbsp;&nbsp;&quot;default&quot;: &quot;"
		+ document.getElementById("default-velocity").value + "&quot;";

	if (
		nr_initial_velocity_items.n > 0
		|| nr_value_velocity_items.n > 0
		|| nr_copy_velocity_items.n > 0
	) {
		new_html += ",<br>";
	}
	if (nr_initial_velocity_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;initial-conditions&quot;: [<br>";
		for (i = 0; i < nr_initial_velocity_items.n; i++) {
			id_string = "initial-velocity-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + ",<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;value&quot;: &quot;"
				+ document.getElementById(id_string + "-value").value + "&quot;"
				+ "}";
			if (i < nr_initial_velocity_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	if (nr_initial_velocity_items.n > 0 && nr_value_velocity_items.n > 0) {
		if (nr_value_velocity_items.n > 0) {
			new_html += ",";
		}
		new_html += "<br>";
	}

	if (nr_value_velocity_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;value-boundaries&quot;: [<br>";
		for (i = 0; i < nr_value_velocity_items.n; i++) {
			id_string = "value-velocity-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + ",<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;time-stamps&quot;: ["
				+ document.getElementById(id_string + "-time-stamps-id").value + "],<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;values&quot;: ["
				+ document.getElementById(id_string + "-value").value.replace(/\{/g, '"{').replace(/\}/g, '}"')
				+ "]}";
			if (i < nr_value_velocity_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	if (
		(nr_initial_velocity_items.n > 0 || nr_value_velocity_items.n > 0)
		&& nr_copy_velocity_items.n > 0
	) {
		if (nr_copy_velocity_items.n > 0) {
			new_html += ",";
		}
		new_html += "<br>";
	}

	if (nr_copy_velocity_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;copy-boundaries&quot;: [<br>";
		for (i = 0; i < nr_copy_velocity_items.n; i++) {
			id_string = "copy-velocity-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + "&nbsp;&nbsp;&nbsp;&nbsp;}";
			if (i < nr_copy_velocity_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	new_html += "<br>},<br>";


	// pressure
	new_html
		+= "&quot;pressure&quot;: {<br>"
		+ "&nbsp;&nbsp;&quot;default&quot;: &quot;"
		+ document.getElementById("default-pressure").value + "&quot;";

	if (
		nr_initial_pressure_items.n > 0
		|| nr_value_pressure_items.n > 0
		|| nr_copy_pressure_items.n > 0
	) {
		new_html += ",<br>";
	}
	if (nr_initial_pressure_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;initial-conditions&quot;: [<br>";
		for (i = 0; i < nr_initial_pressure_items.n; i++) {
			id_string = "initial-pressure-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + ",<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;value&quot;: &quot;"
				+ document.getElementById(id_string + "-value").value + "&quot;"
				+ "}";
			if (i < nr_initial_pressure_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	if (nr_initial_pressure_items.n > 0 && nr_value_pressure_items.n > 0) {
		if (nr_value_pressure_items.n > 0) {
			new_html += ",";
		}
		new_html += "<br>";
	}

	if (nr_value_pressure_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;value-boundaries&quot;: [<br>";
		for (i = 0; i < nr_value_pressure_items.n; i++) {
			id_string = "value-pressure-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + ",<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;time-stamps&quot;: ["
				+ document.getElementById(id_string + "-time-stamps-id").value + "],<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;values&quot;: ["
				+ '"' + document.getElementById(id_string + "-value").value.replace(/\,/g, '","')
				+ '"]}';
			if (i < nr_value_pressure_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	if (
		(nr_initial_pressure_items.n > 0 || nr_value_pressure_items.n > 0)
		&& nr_copy_pressure_items.n > 0
	) {
		if (nr_copy_pressure_items.n > 0) {
			new_html += ",";
		}
		new_html += "<br>";
	}

	if (nr_copy_pressure_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;copy-boundaries&quot;: [<br>";
		for (i = 0; i < nr_copy_pressure_items.n; i++) {
			id_string = "copy-pressure-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + "&nbsp;&nbsp;&nbsp;&nbsp;}";
			if (i < nr_copy_pressure_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	new_html += "<br>},<br>";


	// magnetic field
	new_html
		+= "&quot;magnetic-field&quot;: {<br>"
		+ "&nbsp;&nbsp;&quot;default&quot;: &quot;"
		+ document.getElementById("default-magnetic-field").value + "&quot;";

	if (
		nr_initial_magnetic_field_items.n > 0
		|| nr_value_magnetic_field_items.n > 0
		|| nr_copy_magnetic_field_items.n > 0
	) {
		new_html += ",<br>";
	}
	if (nr_initial_magnetic_field_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;initial-conditions&quot;: [<br>";
		for (i = 0; i < nr_initial_magnetic_field_items.n; i++) {
			id_string = "initial-magnetic-field-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + ",<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;value&quot;: &quot;"
				+ document.getElementById(id_string + "-value").value + "&quot;"
				+ "}";
			if (i < nr_initial_magnetic_field_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	if (nr_initial_magnetic_field_items.n > 0 && nr_value_magnetic_field_items.n > 0) {
		if (nr_value_magnetic_field_items.n > 0) {
			new_html += ",";
		}
		new_html += "<br>";
	}

	if (nr_value_magnetic_field_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;value-boundaries&quot;: [<br>";
		for (i = 0; i < nr_value_magnetic_field_items.n; i++) {
			id_string = "value-magnetic-field-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + ",<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;time-stamps&quot;: ["
				+ document.getElementById(id_string + "-time-stamps-id").value + "],<br>"
				+ "&nbsp;&nbsp;&nbsp;&nbsp;&quot;values&quot;: ["
				+ document.getElementById(id_string + "-value").value.replace(/\{/g, '"{').replace(/\}/g, '}"')
				+ "]}";
			if (i < nr_value_magnetic_field_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	if (
		(nr_initial_magnetic_field_items.n > 0 || nr_value_magnetic_field_items.n > 0)
		&& nr_copy_magnetic_field_items.n > 0
	) {
		if (nr_copy_magnetic_field_items.n > 0) {
			new_html += ",";
		}
		new_html += "<br>";
	}

	if (nr_copy_magnetic_field_items.n > 0) {
		new_html += "&nbsp;&nbsp;&quot;copy-boundaries&quot;: [<br>";
		for (i = 0; i < nr_copy_magnetic_field_items.n; i++) {
			id_string = "copy-magnetic-field-" + i.toString();
			new_html
				+= "&nbsp;&nbsp;&nbsp;&nbsp;{&quot;geometry-id&quot;: "
				+ document.getElementById(id_string + "-geometry-id").value + "&nbsp;&nbsp;&nbsp;&nbsp;}";
			if (i < nr_copy_magnetic_field_items.n - 1) {
				new_html += ",<br>";
			} else {
				new_html += "<br>";
			}
		}
		new_html += "&nbsp;&nbsp;]";
	}

	new_html += "<br>}<br>}";


	var config_text = document.getElementById("config_text");
	while (config_text.hasChildNodes()) {
	    config_text.removeChild(config_text.firstChild);
	}
	config_text.innerHTML = new_html;
});


// button for filling the form with shock tube configuration
var shock_tube_maker = document.getElementById("make_shock_tube");
shock_tube_maker.addEventListener("click", function() {
	configuration_clearer.click();
	document.getElementById("solver-mhd").selectedIndex = 3;
	document.getElementById("time-start").value = 0;
	document.getElementById("time-length").value = 1;
	document.getElementById("minimum-pressure").value = 0;
	document.getElementById("save-mhd-n").value = 0.1;
	document.getElementById("resistivity").value = 0;
	document.getElementById("remove-div-b-n").value = -1;
	document.getElementById("adiabatic-index").value = 1.6666667;
	document.getElementById("vacuum-permeability").value = 1;
	document.getElementById("proton-mass").value = 1;
	document.getElementById("time-step-factor").value = 0.5;
	document.getElementById("output-directory").value = "shock_tube/";
	document.getElementById("periodic-x").selectedIndex = 0;
	document.getElementById("periodic-y").selectedIndex = 0;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("cells").value = "{100 + 2, 1, 1}";
	document.getElementById("volume").value = "{1 + 2 / (cells[0] - 2), 1, 1}";
	document.getElementById("start").value = "{-volume[0]/2, -volume[1]/2, -volume[2]/2}";
	document.getElementById("default-mass").value = "x < 0 ? 1 : 0.125";
	document.getElementById("default-pressure").value = "x < 0 ? 1 : 0.1";
	document.getElementById("default-velocity").value = "{0, 0, 0}";
	document.getElementById("default-magnetic-field").value = "{0.75, x < 0 ? 1 : -1, 0}";
	box_geometry_adder.click();
	document.getElementById("box0-startx").value = -99;
	document.getElementById("box0-starty").value = -99;
	document.getElementById("box0-startz").value = -99;
	document.getElementById("box0-endx").value = -0.5;
	document.getElementById("box0-endy").value = 99;
	document.getElementById("box0-endz").value = 99;
	document.getElementById("background-B-value-x").value = 0;
	document.getElementById("background-B-value-y").value = 0;
	document.getElementById("background-B-value-z").value = 0;
	document.getElementById("dipole-min-distance").value = 1;
	value_mass_adder.click();
	document.getElementById("value-mass-0-geometry-id").value = 0;
	document.getElementById("value-mass-0-time-stamps-id").value = 0;
	document.getElementById("value-mass-0-value").value = 1;
	value_velocity_adder.click();
	document.getElementById("value-velocity-0-geometry-id").value = 0;
	document.getElementById("value-velocity-0-time-stamps-id").value = 0;
	document.getElementById("value-velocity-0-value").value = "{0, 0, 0}";
	value_pressure_adder.click();
	document.getElementById("value-pressure-0-geometry-id").value = 0;
	document.getElementById("value-pressure-0-time-stamps-id").value = 0;
	document.getElementById("value-pressure-0-value").value = 1;
	value_magnetic_field_adder.click();
	document.getElementById("value-magnetic-field-0-geometry-id").value = 0;
	document.getElementById("value-magnetic-field-0-time-stamps-id").value = 0;
	document.getElementById("value-magnetic-field-0-value").value = "{0.75, 1, 0}";
	box_geometry_adder.click();
	document.getElementById("box1-startx").value = 0.5;
	document.getElementById("box1-starty").value = -99;
	document.getElementById("box1-startz").value = -99;
	document.getElementById("box1-endx").value = 99;
	document.getElementById("box1-endy").value = 99;
	document.getElementById("box1-endz").value = 99;
	value_mass_adder.click();
	document.getElementById("value-mass-1-geometry-id").value = 1;
	document.getElementById("value-mass-1-time-stamps-id").value = 0;
	document.getElementById("value-mass-1-value").value = 0.125;
	value_velocity_adder.click();
	document.getElementById("value-velocity-1-geometry-id").value = 1;
	document.getElementById("value-velocity-1-time-stamps-id").value = 0;
	document.getElementById("value-velocity-1-value").value = "{0, 0, 0}";
	value_pressure_adder.click();
	document.getElementById("value-pressure-1-geometry-id").value = 1;
	document.getElementById("value-pressure-1-time-stamps-id").value = 0;
	document.getElementById("value-pressure-1-value").value = 0.1;
	value_magnetic_field_adder.click();
	document.getElementById("value-magnetic-field-1-geometry-id").value = 1;
	document.getElementById("value-magnetic-field-1-time-stamps-id").value = 0;
	document.getElementById("value-magnetic-field-1-value").value = "{0.75, -1, 0}";
	update_config_text.click();
});

var kelvin_helmholtz_maker = document.getElementById("make_kelvin_helmholtz");
kelvin_helmholtz_maker.addEventListener("click", function() {
	configuration_clearer.click();
	document.getElementById("solver-mhd").selectedIndex = 3;
	document.getElementById("time-start").value = 0;
	document.getElementById("time-length").value = 12;
	document.getElementById("minimum-pressure").value = 0;
	document.getElementById("save-mhd-n").value = 1;
	document.getElementById("resistivity").value = 0;
	document.getElementById("remove-div-b-n").value = 0.05;
	document.getElementById("adiabatic-index").value = 1.4;
	document.getElementById("vacuum-permeability").value = 1;
	document.getElementById("proton-mass").value = 1;
	document.getElementById("time-step-factor").value = 0.5;
	document.getElementById("output-directory").value = "kelvin-helmholtz/";
	document.getElementById("periodic-x").selectedIndex = 1;
	document.getElementById("periodic-y").selectedIndex = 1;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("cells").value = "{50, 50, 1}";
	document.getElementById("volume").value = "{1, 1, 1}";
	document.getElementById("start").value = "{-volume[0]/2, -volume[1]/2, -volume[2]/2}";
	document.getElementById("background-B-value-x").value = 0;
	document.getElementById("background-B-value-y").value = 0;
	document.getElementById("background-B-value-z").value = 0;
	document.getElementById("dipole-min-distance").value = 1;
	document.getElementById("default-mass").value = "abs(y) < 0.25 ? 2 : 15";
	document.getElementById("default-pressure").value = 3;
	document.getElementById("default-velocity").value = "{0.1 * sin(2*pi*x) + (abs(y) < 0.25 ? -0.5 : 0.5), 0.1 * cos(2*pi*x), 0}";
	document.getElementById("default-magnetic-field").value = "{0.25, 0, 0}";
	update_config_text.click();
});

var reconnection_maker = document.getElementById("make_reconnection");
reconnection_maker.addEventListener("click", function() {
	configuration_clearer.click();
	document.getElementById("solver-mhd").selectedIndex = 3;
	document.getElementById("time-start").value = 0;
	document.getElementById("time-length").value = 20;
	document.getElementById("minimum-pressure").value = 0;
	document.getElementById("save-mhd-n").value = 1;
	document.getElementById("resistivity").value = 0;
	document.getElementById("remove-div-b-n").value = 0.2;
	document.getElementById("adiabatic-index").value = 1.666667;
	document.getElementById("vacuum-permeability").value = 1;
	document.getElementById("proton-mass").value = 1;
	document.getElementById("time-step-factor").value = 0.5;
	document.getElementById("output-directory").value = "reconnection/";
	document.getElementById("periodic-x").selectedIndex = 1;
	document.getElementById("periodic-y").selectedIndex = 0;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("cells").value = "{2*51, 1, 51 + 2}";
	document.getElementById("volume").value = "{25.6, 12.8, 12.8 * (1 + 2/(cells[2] - 2))}";
	document.getElementById("start").value = "{-volume[0]/2, -volume[1]/2, -volume[2]/2}";
	document.getElementById("default-mass").value = "1/cosh(z / 0.5)^2 + 0.2";
	document.getElementById("default-pressure").value = 1;
	document.getElementById("default-velocity").value = "{0, 0, 0}";
	document.getElementById("default-magnetic-field").value = "{tanh(z / 0.5) - 0.1 * pi/12.8 * cos(2*pi*x/25.6) * sin(pi*z/12.8), 0, 0.1 * 2*pi/25.6 * sin(2*pi*x/25.6) * cos(pi*z/12.8)}";
	box_geometry_adder.click();
	document.getElementById("box0-startx").value = -99;
	document.getElementById("box0-starty").value = -99;
	document.getElementById("box0-startz").value = 6.4;
	document.getElementById("box0-endx").value = 99;
	document.getElementById("box0-endy").value = 99;
	document.getElementById("box0-endz").value = 99;
	document.getElementById("background-B-value-x").value = 0;
	document.getElementById("background-B-value-y").value = 0;
	document.getElementById("background-B-value-z").value = 0;
	document.getElementById("dipole-min-distance").value = 1;
	copy_mass_adder.click();
	document.getElementById("copy-mass-0-geometry-id").value = 0;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-0-geometry-id").value = 0;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-0-geometry-id").value = 0;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-0-geometry-id").value = 0;
	box_geometry_adder.click();
	document.getElementById("box1-startx").value = -99;
	document.getElementById("box1-starty").value = -99;
	document.getElementById("box1-startz").value = -99;
	document.getElementById("box1-endx").value = 99;
	document.getElementById("box1-endy").value = 99;
	document.getElementById("box1-endz").value = -6.4;
	copy_mass_adder.click();
	document.getElementById("copy-mass-1-geometry-id").value = 1;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-1-geometry-id").value = 1;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-1-geometry-id").value = 1;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-1-geometry-id").value = 1;
	update_config_text.click();
});

var orszag_tang_maker = document.getElementById("make_orszag_tang");
orszag_tang_maker.addEventListener("click", function() {
	configuration_clearer.click();
	document.getElementById("solver-mhd").selectedIndex = 3;
	document.getElementById("time-start").value = 0;
	document.getElementById("time-length").value = 5;
	document.getElementById("minimum-pressure").value = 0;
	document.getElementById("save-mhd-n").value = 0.5;
	document.getElementById("resistivity").value = 0;
	document.getElementById("remove-div-b-n").value = 0.1;
	document.getElementById("adiabatic-index").value = 1.666667;
	document.getElementById("vacuum-permeability").value = 1;
	document.getElementById("proton-mass").value = 1;
	document.getElementById("time-step-factor").value = 0.5;
	document.getElementById("output-directory").value = "orszag-tang/";
	document.getElementById("periodic-x").selectedIndex = 1;
	document.getElementById("periodic-y").selectedIndex = 1;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("cells").value = "{40, 40, 1}";
	document.getElementById("volume").value = "{2*pi, 2*pi, 1}";
	document.getElementById("start").value = "{0, 0, 0}";
	document.getElementById("background-B-value-x").value = 0;
	document.getElementById("background-B-value-y").value = 0;
	document.getElementById("background-B-value-z").value = 0;
	document.getElementById("dipole-min-distance").value = 1;
	document.getElementById("default-mass").value = 1;
	document.getElementById("default-velocity").value = "{-sin(y), sin(x), 0}";
	document.getElementById("default-pressure").value = 1;
	document.getElementById("default-magnetic-field").value = "{-sin(y), sin(2*x), 0}";
	update_config_text.click();
});

var bow_shock_maker = document.getElementById("make_bow_shock");
bow_shock_maker.addEventListener("click", function() {
	configuration_clearer.click();
	document.getElementById("solver-mhd").selectedIndex = 2;
	document.getElementById("time-start").value = 0;
	document.getElementById("time-length").value = 10;
	document.getElementById("minimum-pressure").value = 0;
	document.getElementById("save-mhd-n").value = 1;
	document.getElementById("resistivity").value = 0;
	document.getElementById("remove-div-b-n").value = -1;
	document.getElementById("adiabatic-index").value = 1.666667;
	document.getElementById("vacuum-permeability").value = 1;
	document.getElementById("proton-mass").value = 1;
	document.getElementById("time-step-factor").value = 0.5;
	document.getElementById("output-directory").value = "bow_shock/";
	document.getElementById("periodic-x").selectedIndex = 0;
	document.getElementById("periodic-y").selectedIndex = 0;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("cells").value = "{2*30 + 2, 3*30 + 2, 1}";
	document.getElementById("volume").value = "{2 * (1 + 2 / (cells[0] - 2)), 3 * (1 + 2 / (cells[1] - 2)), 2}";
	document.getElementById("start").value = "{-volume[0]/2, -volume[1]/2, -volume[2]/2}";
	document.getElementById("default-mass").value = 0.01;
	document.getElementById("default-velocity").value = "{x > 0 and y < 0.0625 and y > -0.0625 ? 0 : 1, 0, 0}";
	document.getElementById("default-pressure").value = 0.0015;
	document.getElementById("default-magnetic-field").value = "{0, 0, 0}";
	document.getElementById("background-B-value-x").value = 0;
	document.getElementById("background-B-value-y").value = 0;
	document.getElementById("background-B-value-z").value = 0;
	document.getElementById("dipole-min-distance").value = 1;

	sphere_geometry_adder.click();
	document.getElementById("sphere0-centerx").value = 0;
	document.getElementById("sphere0-centery").value = 0;
	document.getElementById("sphere0-centerz").value = 0;
	document.getElementById("sphere0-radius").value = 0.0625;
	initial_mass_adder.click();
	document.getElementById("initial-mass-0-geometry-id").value = 0;
	document.getElementById("initial-mass-0-value").value = 100;
	initial_velocity_adder.click();
	document.getElementById("initial-velocity-0-geometry-id").value = 0;
	document.getElementById("initial-velocity-0-value").value = "{0, 0, 0}";
	initial_pressure_adder.click();
	document.getElementById("initial-pressure-0-geometry-id").value = 0;
	document.getElementById("initial-pressure-0-value").value = 0.0015;
	initial_magnetic_field_adder.click();
	document.getElementById("initial-magnetic-field-0-geometry-id").value = 0;
	document.getElementById("initial-magnetic-field-0-value").value = "{0, 0, 0}";

	box_geometry_adder.click();
	document.getElementById("box1-startx").value = -99;
	document.getElementById("box1-starty").value = -99;
	document.getElementById("box1-startz").value = -99;
	document.getElementById("box1-endx").value = -1;
	document.getElementById("box1-endy").value = 99;
	document.getElementById("box1-endz").value = 99;
	value_mass_adder.click();
	document.getElementById("value-mass-0-geometry-id").value = 1;
	document.getElementById("value-mass-0-time-stamps-id").value = 0;
	document.getElementById("value-mass-0-value").value = 0.01;
	value_velocity_adder.click();
	document.getElementById("value-velocity-0-geometry-id").value = 1;
	document.getElementById("value-velocity-0-time-stamps-id").value = 0;
	document.getElementById("value-velocity-0-value").value = "{1, 0, 0}";
	value_pressure_adder.click();
	document.getElementById("value-pressure-0-geometry-id").value = 1;
	document.getElementById("value-pressure-0-time-stamps-id").value = 0;
	document.getElementById("value-pressure-0-value").value = 0.0015;
	value_magnetic_field_adder.click();
	document.getElementById("value-magnetic-field-0-geometry-id").value = 1;
	document.getElementById("value-magnetic-field-0-time-stamps-id").value = 0;
	document.getElementById("value-magnetic-field-0-value").value = "{0, 0, 0}";

	box_geometry_adder.click();
	document.getElementById("box2-startx").value = 1;
	document.getElementById("box2-starty").value = -99;
	document.getElementById("box2-startz").value = -99;
	document.getElementById("box2-endx").value = 99;
	document.getElementById("box2-endy").value = 99;
	document.getElementById("box2-endz").value = 99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-0-geometry-id").value = 2;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-0-geometry-id").value = 2;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-0-geometry-id").value = 2;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-0-geometry-id").value = 2;

	box_geometry_adder.click();
	document.getElementById("box3-startx").value = -99;
	document.getElementById("box3-starty").value = 1.5;
	document.getElementById("box3-startz").value = -99;
	document.getElementById("box3-endx").value = 99;
	document.getElementById("box3-endy").value = 99;
	document.getElementById("box3-endz").value = 99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-1-geometry-id").value = 3;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-1-geometry-id").value = 3;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-1-geometry-id").value = 3;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-1-geometry-id").value = 3;

	box_geometry_adder.click();
	document.getElementById("box4-startx").value = -99;
	document.getElementById("box4-starty").value = -99;
	document.getElementById("box4-startz").value = -99;
	document.getElementById("box4-endx").value = 99;
	document.getElementById("box4-endy").value = -1.5;
	document.getElementById("box4-endz").value = 99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-2-geometry-id").value = 4;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-2-geometry-id").value = 4;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-2-geometry-id").value = 4;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-2-geometry-id").value = 4;

	update_config_text.click();
});

var blast_wave_maker = document.getElementById("make_blast_wave");
blast_wave_maker.addEventListener("click", function() {
	configuration_clearer.click();
	document.getElementById("solver-mhd").selectedIndex = 3;
	document.getElementById("time-start").value = 0;
	document.getElementById("time-length").value = 0.5;
	document.getElementById("minimum-pressure").value = 0;
	document.getElementById("save-mhd-n").value = 0.05;
	document.getElementById("resistivity").value = 0;
	document.getElementById("remove-div-b-n").value = 0.05;
	document.getElementById("adiabatic-index").value = 1.666667;
	document.getElementById("vacuum-permeability").value = 1;
	document.getElementById("proton-mass").value = 1;
	document.getElementById("time-step-factor").value = 0.5;
	document.getElementById("output-directory").value = "blast_wave/";
	document.getElementById("periodic-x").selectedIndex = 1;
	document.getElementById("periodic-y").selectedIndex = 1;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("cells").value = "{100, 100, 1}";
	document.getElementById("volume").value = "{1, 1, 1}";
	document.getElementById("start").value = "{-0.5, -0.5, -0.5}";
	document.getElementById("default-mass").value = 1;
	document.getElementById("default-velocity").value = "{0, 0, 0}";
	document.getElementById("default-pressure").value = 0.1;
	document.getElementById("default-magnetic-field").value = "{1/sqrt(2), 1/sqrt(2), 0}";
	document.getElementById("background-B-value-x").value = 0;
	document.getElementById("background-B-value-y").value = 0;
	document.getElementById("background-B-value-z").value = 0;
	document.getElementById("dipole-min-distance").value = 1;
	sphere_geometry_adder.click();
	document.getElementById("sphere0-centerx").value = 0;
	document.getElementById("sphere0-centery").value = 0;
	document.getElementById("sphere0-centerz").value = 0;
	document.getElementById("sphere0-radius").value = 0.125;
	initial_mass_adder.click();
	document.getElementById("initial-mass-0-geometry-id").value = 0;
	document.getElementById("initial-mass-0-value").value = 1;
	initial_velocity_adder.click();
	document.getElementById("initial-velocity-0-geometry-id").value = 0;
	document.getElementById("initial-velocity-0-value").value = "{0, 0, 0}";
	initial_pressure_adder.click();
	document.getElementById("initial-pressure-0-geometry-id").value = 0;
	document.getElementById("initial-pressure-0-value").value = 10;
	initial_magnetic_field_adder.click();
	document.getElementById("initial-magnetic-field-0-geometry-id").value = 0;
	document.getElementById("initial-magnetic-field-0-value").value = "{1/sqrt(2), 1/sqrt(2), 0}";
	update_config_text.click();
});

var jet_injection_maker = document.getElementById("make_jet_injection");
jet_injection_maker.addEventListener("click", function() {
	configuration_clearer.click();
	document.getElementById("solver-mhd").selectedIndex = 3;
	document.getElementById("time-start").value = 0;
	document.getElementById("time-length").value = 2;
	document.getElementById("minimum-pressure").value = 0;
	document.getElementById("save-mhd-n").value = 0.1;
	document.getElementById("resistivity").value = 0;
	document.getElementById("remove-div-b-n").value = -1;
	document.getElementById("adiabatic-index").value = 1.666667;
	document.getElementById("vacuum-permeability").value = 1;
	document.getElementById("proton-mass").value = 1;
	document.getElementById("time-step-factor").value = 0.5;
	document.getElementById("output-directory").value = "jet_injection/";
	document.getElementById("periodic-x").selectedIndex = 0;
	document.getElementById("periodic-y").selectedIndex = 0;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("cells").value = "{40 + 2, 20 + 2, 1}";
	document.getElementById("volume").value = "{3 * (1 + 2 / (cells[0] - 2)), 1.5 * (1 + 2 / (cells[1] - 2)), 1}";
	document.getElementById("start").value = "{-volume[0] / cells[0], -volume[1] / cells[1], 0}";
	document.getElementById("default-mass").value = 1;
	document.getElementById("default-velocity").value = "{2.7 - x/2, 0, 0}";
	document.getElementById("default-pressure").value = 1;
	document.getElementById("default-magnetic-field").value = "{0, 0, 0}";
	document.getElementById("background-B-value-x").value = 0;
	document.getElementById("background-B-value-y").value = 0;
	document.getElementById("background-B-value-z").value = 0;
	document.getElementById("dipole-min-distance").value = 1;

	box_geometry_adder.click();
	document.getElementById("box0-startx").value = -99;
	document.getElementById("box0-starty").value = -99;
	document.getElementById("box0-startz").value = -99;
	document.getElementById("box0-endx").value = -0.0001;
	document.getElementById("box0-endy").value = 99;
	document.getElementById("box0-endz").value = 99;
	value_mass_adder.click();
	document.getElementById("value-mass-0-geometry-id").value = 0;
	document.getElementById("value-mass-0-time-stamps-id").value = 0;
	document.getElementById("value-mass-0-value").value = 1;
	value_velocity_adder.click();
	document.getElementById("value-velocity-0-geometry-id").value = 0;
	document.getElementById("value-velocity-0-time-stamps-id").value = 0;
	document.getElementById("value-velocity-0-value").value = "{2.7, 0, 0}";
	value_pressure_adder.click();
	document.getElementById("value-pressure-0-geometry-id").value = 0;
	document.getElementById("value-pressure-0-time-stamps-id").value = 0;
	document.getElementById("value-pressure-0-value").value = 1;
	value_magnetic_field_adder.click();
	document.getElementById("value-magnetic-field-0-geometry-id").value = 0;
	document.getElementById("value-magnetic-field-0-time-stamps-id").value = 0;
	document.getElementById("value-magnetic-field-0-value").value = "{0, 0, 0}";

	box_geometry_adder.click();
	document.getElementById("box1-startx").value = 1.4001;
	document.getElementById("box1-starty").value = -99;
	document.getElementById("box1-startz").value = -99;
	document.getElementById("box1-endx").value = 1.5999;
	document.getElementById("box1-endy").value = -0.0001;
	document.getElementById("box1-endz").value = 99;
	value_mass_adder.click();
	document.getElementById("value-mass-1-geometry-id").value = 1;
	document.getElementById("value-mass-1-time-stamps-id").value = 0;
	document.getElementById("value-mass-1-value").value = 5;
	value_velocity_adder.click();
	document.getElementById("value-velocity-1-geometry-id").value = 1;
	document.getElementById("value-velocity-1-time-stamps-id").value = 0;
	document.getElementById("value-velocity-1-value").value = "{0, 1.3, 0}";
	value_pressure_adder.click();
	document.getElementById("value-pressure-1-geometry-id").value = 1;
	document.getElementById("value-pressure-1-time-stamps-id").value = 0;
	document.getElementById("value-pressure-1-value").value = 5;
	value_magnetic_field_adder.click();
	document.getElementById("value-magnetic-field-1-geometry-id").value = 1;
	document.getElementById("value-magnetic-field-1-time-stamps-id").value = 0;
	document.getElementById("value-magnetic-field-1-value").value = "{0, 0, 0}";

	box_geometry_adder.click();
	document.getElementById("box2-startx").value = 3.0001;
	document.getElementById("box2-starty").value = -99;
	document.getElementById("box2-startz").value = -99;
	document.getElementById("box2-endx").value = 99;
	document.getElementById("box2-endy").value = 99;
	document.getElementById("box2-endz").value = 99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-0-geometry-id").value = 2;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-0-geometry-id").value = 2;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-0-geometry-id").value = 2;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-0-geometry-id").value = 2;

	box_geometry_adder.click();
	document.getElementById("box3-startx").value = -99;
	document.getElementById("box3-starty").value = 1.5001;
	document.getElementById("box3-startz").value = -99;
	document.getElementById("box3-endx").value = 99;
	document.getElementById("box3-endy").value = 99;
	document.getElementById("box3-endz").value = 99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-1-geometry-id").value = 3;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-1-geometry-id").value = 3;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-1-geometry-id").value = 3;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-1-geometry-id").value = 3;

	box_geometry_adder.click();
	document.getElementById("box4-startx").value = 0.0001;
	document.getElementById("box4-starty").value = -99;
	document.getElementById("box4-startz").value = -99;
	document.getElementById("box4-endx").value = 1.3999;
	document.getElementById("box4-endy").value = -0.0001;
	document.getElementById("box4-endz").value = 99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-2-geometry-id").value = 4;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-2-geometry-id").value = 4;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-2-geometry-id").value = 4;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-2-geometry-id").value = 4;

	box_geometry_adder.click();
	document.getElementById("box5-startx").value = 1.6001;
	document.getElementById("box5-starty").value = -99;
	document.getElementById("box5-startz").value = -99;
	document.getElementById("box5-endx").value = 99;
	document.getElementById("box5-endy").value = -0.0001;
	document.getElementById("box5-endz").value = 99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-3-geometry-id").value = 5;
	copy_velocity_adder.click()
	document.getElementById("copy-velocity-3-geometry-id").value = 5;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-3-geometry-id").value = 5;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-3-geometry-id").value = 5;

	update_config_text.click();
});

var msphere_maker = document.getElementById("make_msphere");
msphere_maker.addEventListener("click", function() {
	configuration_clearer.click();
	document.getElementById("solver-mhd").selectedIndex = 0;
	document.getElementById("time-start").value = 0;
	document.getElementById("time-length").value = 7200;
	document.getElementById("minimum-pressure").value = 0;
	document.getElementById("save-mhd-n").value = 1200;
	document.getElementById("resistivity").value = 0;
	document.getElementById("remove-div-b-n").value = 10;
	document.getElementById("adiabatic-index").value = 1.666667;
	document.getElementById("vacuum-permeability").value = 1.2566370614359173e-06;
	document.getElementById("proton-mass").value = 1.6726217770000001e-27;
	document.getElementById("time-step-factor").value = 0.4;
	document.getElementById("output-directory").value = "magnetosphere/";
	document.getElementById("periodic-x").selectedIndex = 0;
	document.getElementById("periodic-y").selectedIndex = 0;
	document.getElementById("periodic-z").selectedIndex = 0;
	document.getElementById("cells").value = "{40 + 2, 30 + 2, 30 + 2}";
	document.getElementById("volume").value = "{200 * 6.371e6 * (1 + 2/(cells[0] - 2)), 150 * 6.371e6 * (1 + 2/(cells[1] - 2)), 150 * 6.371e6 * (1 + 2/(cells[2] - 2))}";
	document.getElementById("start").value = "{-(1/2 + 1/4*cells[0]) * volume[0] / cells[0], -volume[1] / 2, -volume[2] / 2}";
	document.getElementById("default-mass").value = 5e6;
	document.getElementById("default-velocity").value = "{6e5, 0, 0}";
	document.getElementById("default-pressure").value = 8e-12;
	document.getElementById("default-magnetic-field").value = "{0, 0, 0}";
	document.getElementById("background-B-value-x").value = 0;
	document.getElementById("background-B-value-y").value = 0;
	document.getElementById("background-B-value-z").value = 0;
	document.getElementById("dipole-min-distance").value = 1e7;
	dipole_adder.click();
	document.getElementById("dipole_0-moment-x").value = 0;
	document.getElementById("dipole_0-moment-y").value = 0;
	document.getElementById("dipole_0-moment-z").value = -7.94e22;
	document.getElementById("dipole_0-position-x").value = 0;
	document.getElementById("dipole_0-position-y").value = 0;
	document.getElementById("dipole_0-position-z").value = 0;

	box_geometry_adder.click();
	document.getElementById("box0-startx").value = -9e99;
	document.getElementById("box0-starty").value = -9e99;
	document.getElementById("box0-startz").value = -9e99;
	document.getElementById("box0-endx").value = -3.186e8;
	document.getElementById("box0-endy").value = 9e99;
	document.getElementById("box0-endz").value = 9e99;
	value_mass_adder.click();
	document.getElementById("value-mass-0-geometry-id").value = 0;
	document.getElementById("value-mass-0-time-stamps-id").value = 0;
	document.getElementById("value-mass-0-value").value = 5e6;
	value_velocity_adder.click();
	document.getElementById("value-velocity-0-geometry-id").value = 0;
	document.getElementById("value-velocity-0-time-stamps-id").value = 0;
	document.getElementById("value-velocity-0-value").value = "{6e5, 0, 0}";
	value_pressure_adder.click();
	document.getElementById("value-pressure-0-geometry-id").value = 0;
	document.getElementById("value-pressure-0-time-stamps-id").value = 0;
	document.getElementById("value-pressure-0-value").value = 8e-12;
	value_magnetic_field_adder.click();
	document.getElementById("value-magnetic-field-0-geometry-id").value = 0;
	document.getElementById("value-magnetic-field-0-time-stamps-id").value = 0;
	document.getElementById("value-magnetic-field-0-value").value = "{0, 0, 5e-9}";

	sphere_geometry_adder.click();
	document.getElementById("sphere1-centerx").value = 0;
	document.getElementById("sphere1-centery").value = 0;
	document.getElementById("sphere1-centerz").value = 0;
	document.getElementById("sphere1-radius").value = 1.3e7;
	value_mass_adder.click();
	document.getElementById("value-mass-1-geometry-id").value = 1;
	document.getElementById("value-mass-1-time-stamps-id").value = 0;
	document.getElementById("value-mass-1-value").value = 1e9;
	value_velocity_adder.click();
	document.getElementById("value-velocity-1-geometry-id").value = 1;
	document.getElementById("value-velocity-1-time-stamps-id").value = 0;
	document.getElementById("value-velocity-1-value").value = "{0, 0, 0}";
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-0-geometry-id").value = 1;
	value_magnetic_field_adder.click();
	document.getElementById("value-magnetic-field-1-geometry-id").value = 1;
	document.getElementById("value-magnetic-field-1-time-stamps-id").value = 0;
	document.getElementById("value-magnetic-field-1-value").value = "{0, 0, 0}";

	box_geometry_adder.click();
	document.getElementById("box2-startx").value = 9.557e8;
	document.getElementById("box2-starty").value = -9e99;
	document.getElementById("box2-startz").value = -9e99;
	document.getElementById("box2-endx").value = 9e99;
	document.getElementById("box2-endy").value = 9e99;
	document.getElementById("box2-endz").value = 9e99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-0-geometry-id").value = 2;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-0-geometry-id").value = 2;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-1-geometry-id").value = 2;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-0-geometry-id").value = 2;

	box_geometry_adder.click();
	document.getElementById("box3-startx").value = -9e99;
	document.getElementById("box3-starty").value = -9e99;
	document.getElementById("box3-startz").value = -9e99;
	document.getElementById("box3-endx").value = 9e99;
	document.getElementById("box3-endy").value = -4.779e8;
	document.getElementById("box3-endz").value = 9e99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-1-geometry-id").value = 3;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-1-geometry-id").value = 3;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-2-geometry-id").value = 3;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-1-geometry-id").value = 3;

	box_geometry_adder.click();
	document.getElementById("box4-startx").value = -9e99;
	document.getElementById("box4-starty").value = 4.779e8;
	document.getElementById("box4-startz").value = -9e99;
	document.getElementById("box4-endx").value = 9e99;
	document.getElementById("box4-endy").value = 9e99;
	document.getElementById("box4-endz").value = 9e99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-2-geometry-id").value = 4;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-2-geometry-id").value = 4;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-3-geometry-id").value = 4;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-2-geometry-id").value = 4;

	box_geometry_adder.click();
	document.getElementById("box5-startx").value = -9e99;
	document.getElementById("box5-starty").value = -9e99;
	document.getElementById("box5-startz").value = -9e99;
	document.getElementById("box5-endx").value = 9e99;
	document.getElementById("box5-endy").value = 9e99;
	document.getElementById("box5-endz").value = -4.779e8;
	copy_mass_adder.click();
	document.getElementById("copy-mass-3-geometry-id").value = 5;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-3-geometry-id").value = 5;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-4-geometry-id").value = 5;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-3-geometry-id").value = 5;

	box_geometry_adder.click();
	document.getElementById("box6-startx").value = -9e99;
	document.getElementById("box6-starty").value = -9e99;
	document.getElementById("box6-startz").value = 4.779e8;
	document.getElementById("box6-endx").value = 9e99;
	document.getElementById("box6-endy").value = 9e99;
	document.getElementById("box6-endz").value = 9e99;
	copy_mass_adder.click();
	document.getElementById("copy-mass-4-geometry-id").value = 6;
	copy_velocity_adder.click();
	document.getElementById("copy-velocity-4-geometry-id").value = 6;
	copy_pressure_adder.click();
	document.getElementById("copy-pressure-5-geometry-id").value = 6;
	copy_magnetic_field_adder.click();
	document.getElementById("copy-magnetic-field-4-geometry-id").value = 6;

	update_config_text.click();
});


// retrieve and fill out list of runs when first clicked
var run_list_retrieved = false;
run_list_button = document.getElementById("run_list_selector");
run_list_button.addEventListener("click", function() {
	if (run_list_retrieved) {
		return;
	}

	default_option = document.getElementById("default_selector_option");

	if (JSON == null) {
		alert("Browser doesn't support parsing JSON data");
		while (run_list_button.firstChild) {
			run_list_button.removeChild(run_list_button.firstChild);
		}
		default_option.innerHTML = 'Parsing JSON not supported by browser';
		return;
	}

	if (default_option != null) {
		default_option.innerHTML = 'Retrieving run list...';
	}

	request = new XMLHttpRequest();
	request.open('POST', 'http://ccmc.gsfc.nasa.gov/ungrouped/LP/LP_search.php', false, 'pamhd', 'run_list_retrieval');
	request.send('0=PAMHD&3=lp_model');
	response = request.responseText;

	if (default_option != null) {
		default_option.parentNode.removeChild(default_option);
	}

	first = true;
	temp = response.split('runnumber=');
	for (i = 0; i < temp.length; i++) {
		if (first) {
			first = false;
			continue;
		}

		run_id = temp[i].split('>')[0];

		opt = document.createElement('option');
		opt.id = run_id;
		opt.value = run_id;
		opt.innerHTML = run_id;
		run_list_button.appendChild(opt);
	}

	run_list_retrieved = true;
});

// fill out configuration from selected run
run_list_button.addEventListener("change", function() {

	document.getElementById(this.value).innerHTML = 'retrieving configuration (' + this.value + ')';

	request = new XMLHttpRequest();
	request.open('GET', 'http://ccmc.gsfc.nasa.gov/results/viewrun.php?domain=LP&runnumber=' + this.value, false, 'pamhd', 'run_config_retrieval');
	request.send();
	response = request.responseText;

	json_str = response.split('<pre>')[1].split('</pre>')[0].trim();
	json = JSON.parse(json_str);

	function set_config_item(item_str, run_id) {
		if (json[item_str] == null) {
			alert('Configuration of run ' + run_id.value + ' does not have a value for "' + item_str + '"');
			document.getElementById(run_id.value).innerHTML = 'failed (' + run_id.value + ')';
			return;
		}
		document.getElementById(item_str).value = json[item_str];
	}

	set_config_item('time-start', this);
	set_config_item('time-length', this);
	set_config_item('resistivity', this);
	set_config_item('minimum-pressure', this);
	set_config_item('save-mhd-n', this);
	set_config_item('adiabatic-index', this);
	set_config_item('vacuum-permeability', this);
	set_config_item('proton-mass', this);
	set_config_item('time-step-factor', this);

	if (json['remove-div-B-n'] == null) {
		alert('Configuration of run ' + this.value + ' does not have a "remove-div-B-n" item');
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	document.getElementById("remove-div-b-n").value = json['remove-div-B-n'];

	if (json['solver-mhd'] == null) {
		alert('Configuration of run ' + this.value + ' does not have a "solver-mhd" item');
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	mhd = json['solver-mhd'];
	if (mhd == 'rusanov') {
		document.getElementById('solver-mhd').selectedIndex = 0;
	} else if (mhd == 'hll_athena') {
		document.getElementById('solver-mhd').selectedIndex = 1;
	} else if (mhd == 'hlld_athena') {
		document.getElementById('solver-mhd').selectedIndex = 2;
	} else if (mhd == 'hlld_athena') {
		document.getElementById('solver-mhd').selectedIndex = 3;
	} else if (mhd == 'roe_athena') {
		document.getElementById('solver-mhd').selectedIndex = 4;
	} else {
		alert('Unexpected value for mhd solver in configuration of run ' + run_id.value + ': ' + mhd);
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}

	if (json['grid-options'] == null) {
		alert('Configuration of run ' + this.value + ' does not have a "grid-options" item');
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	grid = json['grid-options'];

	if (grid.periodic == null) {
		alert('"grid-options" of run ' + this.value + ' does not have a "periodic" item');
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	periodic = grid.periodic.split('{')[1].split('}')[0].split(', ');
	if (periodic[0] == 'false') {
		document.getElementById("periodic-x").selectedIndex = 0;
	} else if (periodic[0] == 'true') {
		document.getElementById("periodic-x").selectedIndex = 1;
	} else {
		alert('Unexpected value in "periodic-x" item of run ' + this.value + ': ' + periodic[0]);
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	if (periodic[1] == 'false') {
		document.getElementById("periodic-y").selectedIndex = 0;
	} else if (periodic[1] == 'true') {
		document.getElementById("periodic-y").selectedIndex = 1;
	} else {
		alert('Unexpected value in "periodic-y" item of run ' + this.value + ': ' + periodic[1]);
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	if (periodic[2] == 'false') {
		document.getElementById("periodic-z").selectedIndex = 0;
	} else if (periodic[2] == 'true') {
		document.getElementById("periodic-z").selectedIndex = 1;
	} else {
		alert('Unexpected value in "periodic-z" item of run ' + this.value + ': ' + periodic[2]);
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}

	if (grid.cells == null) {
		alert('"grid-options" of run ' + this.value + ' does not have a "cells" item');
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	document.getElementById("cells").value = grid.cells;

	if (grid.volume == null) {
		alert('"grid-options" of run ' + this.value + ' does not have a "volume" item');
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	document.getElementById("volume").value = grid.volume;

	if (grid.start == null) {
		alert('"grid-options" of run ' + this.value + ' does not have a "start" item');
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	document.getElementById("start").value = grid.start;


	if (json.geometries == null) {
		alert('Configuration of run ' + this.value + ' does not have a "geometries" item');
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	for (i = 0; i < json.geometries.length; i++) {
		shape = json.geometries[i];
		if (shape.box != null) {
			box = shape.box;
			if (box.start == null) {
				alert('Box at geometry id ' + i.toString() + ' of run ' + this.value + "doesn't have a start item");
				document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
				return;
			}

			if (box.end == null) {
				alert('Box at geometry id ' + i.toString() + ' of run ' + this.value + "doesn't have an end item");
				document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
				return;
			}

			box_geometry_adder.click();
			box_id = 'box' + i.toString();
			document.getElementById(box_id + '-startx').value = box.start[0];
			document.getElementById(box_id + '-starty').value = box.start[1];
			document.getElementById(box_id + '-startz').value = box.start[2];
			document.getElementById(box_id + '-endx').value = box.end[0];
			document.getElementById(box_id + '-endy').value = box.end[1];
			document.getElementById(box_id + '-endz').value = box.end[2];
		}

		if (shape.sphere != null) {
			sphere = shape.sphere;
			if (sphere.radius == null) {
				alert('Sphere at geometry id ' + i.toString() + ' of run ' + this.value + "doesn't have a radius item");
				document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
				return;
			}
			if (sphere.center == null) {
				alert('Sphere at geometry id ' + i.toString() + ' of run ' + this.value + "doesn't have a center item");
				document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
				return;
			}

			sphere_geometry_adder.click();
			sphere_id = 'sphere' + i.toString();
			document.getElementById(sphere_id + '-centerx').value = sphere.center[0];
			document.getElementById(sphere_id + '-centery').value = sphere.center[1];
			document.getElementById(sphere_id + '-centerz').value = sphere.center[2];
			document.getElementById(sphere_id + '-radius').value = sphere.radius;
		}
	}

	// background magnetic field
	document.getElementById("background-B-value-x").value = 0;
	document.getElementById("background-B-value-y").value = 0;
	document.getElementById("background-B-value-z").value = 0;
	document.getElementById("dipole-min-distance").value = 1;
	if (json['background-magnetic-field'] != null) {
		bg_B = json['background-magnetic-field'];

		if (bg_B.value != null) {
			document.getElementById("background-B-value-x").value = bg_B.value[0];
			document.getElementById("background-B-value-y").value = bg_B.value[1];
			document.getElementById("background-B-value-z").value = bg_B.value[2];
		}

		if (bg_B['minimum-distance'] != null) {
			document.getElementById("dipole-min-distance").value = bg_B['minimum-distance'];
		}

		if (bg_B.dipoles != null) {
			for (i = 0; i < bg_B.dipoles.length; i++) {
				dipole_adder.click();
				dipole_id = 'dipole_' + i.toString();

				dip = bg_B.dipoles[i];
				if (!dip.moment) {
					alert('Dipole ' + i.toString() + " doesn't have moment key");
					document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
					return;
				}
				if (!dip.position) {
					alert('Dipole ' + i.toString() + " doesn't have position key");
					document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
					return;
				}

				document.getElementById(dipole_id + "-moment-x").value = dip.moment[0];
				document.getElementById(dipole_id + "-moment-y").value = dip.moment[1];
				document.getElementById(dipole_id + "-moment-z").value = dip.moment[2];
				document.getElementById(dipole_id + "-position-x").value = dip.position[0];
				document.getElementById(dipole_id + "-position-y").value = dip.position[1];
				document.getElementById(dipole_id + "-position-z").value = dip.position[2];
			}
		}
	}


	if (json['number-density'] == null) {
		alert('Run ' + this.value + " doesn't have number-density key");
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	mass = json['number-density'];
	document.getElementById("default-mass").value = mass.default;

	if (mass['initial-conditions'] != null) {
		init_mass = mass['initial-conditions'];

		for (i = 0; i < init_mass.length; i++) {
			initial_mass_adder.click();
			id = 'inital-mass-' + i.toString();
			document.getElementById(id_string + "-geometry-id").value = init_mass[i]['geometry-id'];
			document.getElementById(id_string + "-value").value = init_mass[i].value;
		}
	}

	if (mass['value-boundaries'] != null) {
		value_mass = mass['value-boundaries'];

		for (i = 0; i < value_mass.length; i++) {
			value_mass_adder.click();
			id = 'value-mass-' + i.toString();

			document.getElementById(id_string + "-geometry-id").value = value_mass[i]['geometry-id'];

			time_stamps_str = '';
			for (j = 0; j < value_mass[i]['time-stamps'].length; j++) {
				time_stamps_str = time_stamps_str + value_mass[i]['time-stamps'][j];
				if (j < value_mass[i]['time-stamps'].length - 1) {
					time_stamps_str = time_stamps_str + ', ';
				}
			}
			document.getElementById(id_string + "-time-stamps-id").value = time_stamps_str;

			if (value_mass[i].values == null) {
				alert('Number density value boundary ' + i.toString() + ' of run ' + this.value + " doesn't have a values key");
				document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
				return;
			}

			values_str = '';
			for (j = 0; j < value_mass[i].values.length; j++) {
				values_str = values_str + value_mass[i].values[j];
				if (j < value_mass[i].values.length - 1) {
					values_str = values_str + ', ';
				}
			}
			document.getElementById(id_string + "-value").value = values_str;
		}
	}

	if (mass['copy-boundaries'] != null) {
		copy_mass = mass['copy-boundaries'];
		for (i = 0; i < copy_mass.length; i++) {
			copy_mass_adder.click();
			id = 'copy-mass-' + i.toString();
			document.getElementById(id_string + "-geometry-id").value = copy_mass[i]['geometry-id'];
		}
	}


	if (json['velocity'] == null) {
		alert('Run ' + this.value + " doesn't have velocity key");
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	velocity = json['velocity'];
	document.getElementById("default-velocity").value = velocity.default;

	if (velocity['initial-conditions'] != null) {
		init_velocity = velocity['initial-conditions'];

		for (i = 0; i < init_velocity.length; i++) {
			initial_velocity_adder.click();
			id = 'inital-velocity-' + i.toString();
			document.getElementById(id_string + "-geometry-id").value = init_velocity[i]['geometry-id'];
			document.getElementById(id_string + "-value").value = init_velocity[i].value;
		}
	}

	if (velocity['value-boundaries'] != null) {
		value_velocity = velocity['value-boundaries'];

		for (i = 0; i < value_velocity.length; i++) {
			value_velocity_adder.click();
			id = 'value-velocity-' + i.toString();

			document.getElementById(id_string + "-geometry-id").value = value_velocity[i]['geometry-id'];

			time_stamps_str = '';
			for (j = 0; j < value_velocity[i]['time-stamps'].length; j++) {
				time_stamps_str = time_stamps_str + value_velocity[i]['time-stamps'][j];
				if (j < value_velocity[i]['time-stamps'].length - 1) {
					time_stamps_str = time_stamps_str + ', ';
				}
			}
			document.getElementById(id_string + "-time-stamps-id").value = time_stamps_str;

			if (value_velocity[i].values == null) {
				alert('Number density value boundary ' + i.toString() + ' of run ' + this.value + " doesn't have a values key");
				document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
				return;
			}

			values_str = '';
			for (j = 0; j < value_velocity[i].values.length; j++) {
				values_str = values_str + value_velocity[i].values[j];
				if (j < value_velocity[i].values.length - 1) {
					values_str = values_str + ', ';
				}
			}
			document.getElementById(id_string + "-value").value = values_str;
		}
	}

	if (velocity['copy-boundaries'] != null) {
		copy_velocity = velocity['copy-boundaries'];
		for (i = 0; i < copy_velocity.length; i++) {
			copy_velocity_adder.click();
			id = 'copy-velocity-' + i.toString();
			document.getElementById(id_string + "-geometry-id").value = copy_velocity[i]['geometry-id'];
		}
	}


	if (json['pressure'] == null) {
		alert('Run ' + this.value + " doesn't have pressure key");
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	pressure = json['pressure'];
	document.getElementById("default-pressure").value = pressure.default;

	if (pressure['initial-conditions'] != null) {
		init_pressure = pressure['initial-conditions'];

		for (i = 0; i < init_pressure.length; i++) {
			initial_pressure_adder.click();
			id = 'inital-pressure-' + i.toString();
			document.getElementById(id_string + "-geometry-id").value = init_pressure[i]['geometry-id'];
			document.getElementById(id_string + "-value").value = init_pressure[i].value;
		}
	}

	if (pressure['value-boundaries'] != null) {
		value_pressure = pressure['value-boundaries'];

		for (i = 0; i < value_pressure.length; i++) {
			value_pressure_adder.click();
			id = 'value-pressure-' + i.toString();

			document.getElementById(id_string + "-geometry-id").value = value_pressure[i]['geometry-id'];

			time_stamps_str = '';
			for (j = 0; j < value_pressure[i]['time-stamps'].length; j++) {
				time_stamps_str = time_stamps_str + value_pressure[i]['time-stamps'][j];
				if (j < value_pressure[i]['time-stamps'].length - 1) {
					time_stamps_str = time_stamps_str + ', ';
				}
			}
			document.getElementById(id_string + "-time-stamps-id").value = time_stamps_str;

			if (value_pressure[i].values == null) {
				alert('Number density value boundary ' + i.toString() + ' of run ' + this.value + " doesn't have a values key");
				document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
				return;
			}

			values_str = '';
			for (j = 0; j < value_pressure[i].values.length; j++) {
				values_str = values_str + value_pressure[i].values[j];
				if (j < value_pressure[i].values.length - 1) {
					values_str = values_str + ', ';
				}
			}
			document.getElementById(id_string + "-value").value = values_str;
		}
	}

	if (pressure['copy-boundaries'] != null) {
		copy_pressure = pressure['copy-boundaries'];
		for (i = 0; i < copy_pressure.length; i++) {
			copy_pressure_adder.click();
			id = 'copy-pressure-' + i.toString();
			document.getElementById(id_string + "-geometry-id").value = copy_pressure[i]['geometry-id'];
		}
	}


	if (json['magnetic-field'] == null) {
		alert('Run ' + this.value + " doesn't have magnetic-field key");
		document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
		return;
	}
	magnetic_field = json['magnetic-field'];
	document.getElementById("default-magnetic-field").value = magnetic_field.default;

	if (magnetic_field['initial-conditions'] != null) {
		init_magnetic_field = magnetic_field['initial-conditions'];

		for (i = 0; i < init_magnetic_field.length; i++) {
			initial_magnetic_field_adder.click();
			id = 'inital-magnetic-field-' + i.toString();
			document.getElementById(id_string + "-geometry-id").value = init_magnetic_field[i]['geometry-id'];
			document.getElementById(id_string + "-value").value = init_magnetic_field[i].value;
		}
	}

	if (magnetic_field['value-boundaries'] != null) {
		value_magnetic_field = magnetic_field['value-boundaries'];

		for (i = 0; i < value_magnetic_field.length; i++) {
			value_magnetic_field_adder.click();
			id = 'value-magnetic-field-' + i.toString();

			document.getElementById(id_string + "-geometry-id").value = value_magnetic_field[i]['geometry-id'];

			time_stamps_str = '';
			for (j = 0; j < value_magnetic_field[i]['time-stamps'].length; j++) {
				time_stamps_str = time_stamps_str + value_magnetic_field[i]['time-stamps'][j];
				if (j < value_magnetic_field[i]['time-stamps'].length - 1) {
					time_stamps_str = time_stamps_str + ', ';
				}
			}
			document.getElementById(id_string + "-time-stamps-id").value = time_stamps_str;

			if (value_magnetic_field[i].values == null) {
				alert('Number density value boundary ' + i.toString() + ' of run ' + this.value + " doesn't have a values key");
				document.getElementById(this.value).innerHTML = 'failed (' + this.value + ')';
				return;
			}

			values_str = '';
			for (j = 0; j < value_magnetic_field[i].values.length; j++) {
				values_str = values_str + value_magnetic_field[i].values[j];
				if (j < value_magnetic_field[i].values.length - 1) {
					values_str = values_str + ', ';
				}
			}
			document.getElementById(id_string + "-value").value = values_str;
		}
	}

	if (magnetic_field['copy-boundaries'] != null) {
		copy_magnetic_field = magnetic_field['copy-boundaries'];
		for (i = 0; i < copy_magnetic_field.length; i++) {
			copy_magnetic_field_adder.click();
			id = 'copy-magnetic-field-' + i.toString();
			document.getElementById(id_string + "-geometry-id").value = copy_magnetic_field[i]['geometry-id'];
		}
	}

	document.getElementById(this.value).innerHTML = 'configuration retrieved (' + this.value + ')';

	update_config_text.click();
});

}

</script>

<!-- javascript block end -->

</head>

<body>

<!-- configuration creator start -->

<h1>Configuration file creator for MHD test program of PAMHD</h1>

<h2>Presets</h2>
<p>
Use these buttons to automatically fill the forms below to create configuration files for some example simulations.
The corresponding configuration can be viewed at the bottom of the page.
If you have installed the model locally you can copy &amp; paste the configuration into a file and give it to pamhd/tests/mhd/test.exe as a command line argument.<br>
<button id="make_shock_tube" type="button">Shock tube</button>
<button id="make_kelvin_helmholtz" type="button">Kelvin-Helmholtz</button>
<button id="make_reconnection" type="button">Reconnection</button>
<button id="make_orszag_tang" type="button">Orszag-Tang</button>
<button id="make_bow_shock" type="button">Bow shock</button>
<button id="make_blast_wave" type="button">Blast wave</button>
<button id="make_jet_injection" type="button">Jet injection</button>
<button id="make_msphere" type="button">Earth's magnetosphere</button>
<select id="run_list_selector">
	<option id="default_selector_option">Import configuration from existing run</option>
</select>
</p>

<h2>Configuration interface</h2>
<p>
Fill out the below forms with simulation parameters.
Use the add and remove buttons to modify the number of additional regions of different types of boundaries for each simulation variable:
<ul>
<li>Initial condition: before simulation is started these regions are filled with given data</li>
<li>Value boundary: when simulation is running these regions are filled with given data after every simulation step</li>
<li>Copy boundary: when simulation is running these regions set their value based on data in nearest non-boundary cells after every simulation step</li>
</ul>
Every type of boundary must refer to a region within the simulation by its geometry id.
Simulation regions have to be added separately using buttons in the geometries part of the form.

<h3>Help on filling out the form</h3>

Input fields on the page set various simulation parameters and all must be filled out.
Vector quantities must be enclosed by curly braces and different components separated by commas.
Values of simulation grid and plasma parameters can be mathematical expressions.
Within an expression, depending on the simulation parameter, different variables can be used to obtain a value for the expression.
For example the center coordinate of a simulation cell is available in expressions as x, y, z, radius, lat and lon.
Lat is angle away from X axis towards Z axis and lon is angle away from X towards Y in radians.
The value of variables available in expressions is set to that of the cell for which the expression is evaluated.
By default the following variables are available within expressions: pi, x, y, z, radius, lat, lon, t.
Variable t is simulation time when an expression is evaluated.

<h4>General simulation parameters</h4>
<ul>
<li>All items except electric resistivity are numbers</li>
<li>Resistivity is an expression that, in addition to regular variables, can also refer to magnitude of current density as J</li>
</ul>

<h4>Simulation grid parameters</h4>
<ul>
<li>All input fields are vector expressions but default variables are not available</li>
<li>Number of cells: no variables available</li>
<li>Volume: number of cells available as cells[0], cells[1] and cells[2] for dimensions x, y and z respectively</li>
<li>Starting coordinate: number of cells and volume available as cells[0], volume[0], etc.</li>
</ul>

<h4>Geometries</h4>
All items are numbers.

<h4>Number density (scalar), velocity (vector), pressure (scalar), magnetic field (vector)</h4>
<ul>
<li>Default, scalar parameter: expression (e.g. radius * sin(x + 2 *pi*t))</li>
<li>Default, vector parameter: expression enclosed in curly brackets ({x/2, sin(t), abs(z^1.5)}) with components separated by commas</li>
<li>Region (geometry id): integer, must be an existing geometry id</li>
<li>Time stamps: number or an ascending comma separated list of numbers (0.1, 3, ...)</li>
<li>Values: as many items as in time stamps separated by commas in the same format as for a default value (e.g. for a vector parameter {x, t, 3/radius}, {y, z, 8}, ...), during simulation the one is used whose corresponding time stamp is closest to current simulation time</li>
</ul>

</p>

<!-- form start -->

<form method="get" id="form">
	<input type="submit" value="Submit run"><br>
	<fieldset id="simulation">
		<legend>General simulation parameters</legend>

		Solver to use
		<select id="solver-mhd" name="solver-mhd" required>
			<option value="rusanov">rusanov</option>
			<option value="hll-athena">hll-athena</option>
			<option value="hlld-athena">hlld-athena</option>
			<option value="roe-athena" selected>roe-athena</option>
		</select> (only rusanov and hll-athena support background field)<br>

		Start time of simulation
		<input type="text" id="time-start" name="time-start"><br>

		Duration of simulation (> 0)
		<input type="text" id="time-length" name="time-length"><br>

		Minimum plasma pressure (>= 0)
		<input type="text" id="minimum-pressure" name="minimum-pressure"><br>

		Time interval for saving simulation results (< 0 skips saving)
		<input type="text" id="save-mhd-n" name="save-mhd-n"><br>

		Expression for electric resistivity (can also refer to magnitude of electric current density as J)
		<input type="text" id="resistivity" name="resistivity"><br>

		Time interval for removing divergence of magnetic field (< 0 skips removal)
		<input type="text" id="remove-div-b-n" name="remove-div-b-n"><br>

		Value of adiabatic index (> 1)
		<input type="text" id="adiabatic-index" name="adiabatic-index"><br>

		Value of vacuum permeability (> 0)
		<input type="text" id="vacuum-permeability" name="vacuum-permeability"><br>

		Value of proton mass (> 0)
		<input type="text" id="proton-mass" name="proton-mass"><br>

		Fraction of maximum allowed time step to use (> 0, < 1)
		<input type="text" id="time-step-factor" name="time-step-factor"><br>

		<!-- outdir start -->
		Output directory for results relative to current directory
		<input
			type="text"
			id="output-directory"
			name="output-directory">
		<br>
		<!-- outdir end -->
	</fieldset>

	<fieldset id="grid">
		<legend>Parameters of simulation grid</legend>
		Periodicity in x, y and z dimensions

		<select id="periodic-x" name="periodic-x" required>
			<option value="false">false</option>
			<option value="true">true</option>
		</select>
		<select id="periodic-y" name="periodic-y" required>
			<option value="false">false</option>
			<option value="true">true</option>
		</select>
		<select id="periodic-z" name="periodic-z" required>
			<option value="false">false</option>
			<option value="true">true</option>
		</select>
		<br>

		Number of cells in x, y and z dimensions (> 0)
		<input type="text" id="cells" name="cells"><br>

		Volume in x, y and z dimensions (> 0)
		<input type="text" id="volume" name="volume"><br>

		Starting coordinate in x, y and z dimensions
		<input type="text" id="start" name="start"><br>
	</fieldset>


	<fieldset id="geometries">
		<legend>Geometries for initial and boundary conditions</legend>

		<button id="add_box_geometry" type="button">
			Add box
		</button>

		<button id="add_sphere_geometry" type="button">
			Add sphere
		</button>

		<button id="remove_geometry_btn" type="button">
			Remove last
		</button>
	</fieldset>


	<fieldset id="background_B">
		<legend>Background magnetic field (curl-free, constant in time, ignored by solvers other than hll-athena)</legend>

		Constant in space part (x, y, z)
		<input type="text" id="background-B-value-x" name="background-B-value-x">
		<input type="text" id="background-B-value-y" name="background-B-value-y">
		<input type="text" id="background-B-value-z" name="background-B-value-z">
		<br>

		Minimum distance from dipole(s) (> 0)
		<input type="text" id="dipole-min-distance" name="dipole-min-distance"><br>

		<button id="add_dipole" type="button">
			Add dipole
		</button>

		<button id="remove_dipole" type="button">
			Remove last
		</button>
	</fieldset>


	<fieldset id="number_density_info">
		<legend>Number density</legend>

		Default (> 0)
		<input type="text" id="default-mass" name="default-mass"><br>

		<button id="add_initial_mass" type="button">
			Add initial condition
		</button>

		<button id="add_value_mass" type="button">
			Add value boundary
		</button>

		<button id="add_copy_mass" type="button">
			Add copy boundary
		</button>
	</fieldset>

	<fieldset id="velocity_info">
		<legend>Velocity</legend>

		Default (mandatory)
		<input type="text" id="default-velocity" name="default-velocity"><br>

		<button id="add_initial_velocity" type="button">
			Add initial condition
		</button>

		<button id="add_value_velocity" type="button">
			Add value boundary
		</button>

		<button id="add_copy_velocity" type="button">
			Add copy boundary
		</button>
	</fieldset>

	<fieldset id="pressure_info">
		<legend>Thermal pressure</legend>

		Default (> 0)
		<input type="text" id="default-pressure" name="default-pressure"><br>

		<button id="add_initial_pressure" type="button">
			Add initial condition
		</button>

		<button id="add_value_pressure" type="button">
			Add value boundary
		</button>

		<button id="add_copy_pressure" type="button">
			Add copy boundary
		</button>
	</fieldset>

	<fieldset id="magnetic_field_info">
		<legend>Magnetic field</legend>

		Default (mandatory)
		<input type="text" id="default-magnetic-field" name="default-magnetic-field"><br>

		<button id="add_initial_magnetic_field" type="button">
			Add initial condition
		</button>

		<button id="add_value_magnetic_field" type="button">
			Add value boundary
		</button>

		<button id="add_copy_magnetic_field" type="button">
			Add copy boundary
		</button>
	</fieldset>

</form>
<button id="clear" type="button">Clear</button><br><br>

<button id="update_config_text" type="button">View configuration</button> 
<samp id="config_text"><br>Push the button above to see current configuration</samp>

<!-- form end -->

</body>
</html>
